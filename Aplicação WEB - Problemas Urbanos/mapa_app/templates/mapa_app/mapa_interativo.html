{% extends 'global/base.html' %}
{% load static %}

{% block title %}Mapa Interativo - {{ block.super }}{% endblock %} 

{# Barra de pesquisa volta para o bloco original ANTES do conteúdo principal do mapa #}
{% block full_width_content_before_main %}
    <div class="global-search-container" role="search">
        <div class="search-input-group">
            <div class="autoComplete_wrapper" style="flex-grow: 1;">
                <input type="search" 
                    id="input-busca-global" 
                    placeholder="Pesquisar endereço ou local..." 
                    aria-label="Campo de pesquisa de endereço ou local"
                    autocomplete="off">
                
            </div>
            <button type="button" class="search-submit-btn" aria-label="Iniciar pesquisa">
                <i class="fas fa-search" aria-hidden="true"></i>
            </button>
        </div>
    </div>
{% endblock %}

{% block content %}
    <div id="mapa-container" aria-label="Mapa interativo da cidade de Osasco">
        {# O mapa Leaflet será renderizado aqui pelo map.js #}
    </div>

    {% if user.is_authenticated %}
    <button id="fab-adicionar-pin" class="fab-add-pin" title="Cadastrar novo problema urbano" aria-label="Cadastrar novo problema urbano no mapa">
        <i class="fas fa-plus" aria-hidden="true"></i>
    </button>
    {% endif %}
{% endblock %}

{% block modals %}
    <div class="modal-overlay" id="overlay-modal" tabindex="-1">
        <div class="modal-content" 
             id="conteudo-modal" 
             role="dialog" 
             aria-modal="true" 
             aria-labelledby="modal-title"
             tabindex="-1">
            <h2 id="modal-title" class="sr-only">Janela Modal</h2>
            <button class="modal-close-btn" aria-label="Fechar janela">
                <i class="fas fa-times" aria-hidden="true"></i>
            </button>
            <div class="modal-body-content">
            </div>
        </div>
    </div>
{% endblock %}

{% block confirmation_messages %}
{% endblock %}

{% block page_specific_scripts %}
    <script src="{% static 'global/js/map.js' %}"></script>
    <script>
        console.log("MAPA_INTERATIVO.HTML: Script específico da página carregado.");
    </script>
{% endblock %}